<!doctype html>
<html>
<head>
    <title>Addresses Partial</title>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/default.min.css">
</head>
<body>

    <form id="addresses_form">
        <label for="name">Enter address line 1: </label>
        <input id="name" type="text" name="name" value="My Address">
        <label for="address_line1">Enter address line 1: </label>
        <input id="address_line1" type="text" name="address_line1" value="210 KING ST">
        <label for="address_line2">Enter address line 2 (optional): </label>
        <input id="address_line2" type="text" name="address_line2" value="">
        <label for="address_city">Enter city: </label>
        <input id="address_city" type="text" name="address_city" value="SAN FRANCISCO">
        <label for="address_state">Enter state: </label>
        <input id="address_state" type="text" name="address_state" value="CA">
        <label for="address_zip">Enter zip code: </label>
        <input id="address_zip" type="text" name="address_zip" value="94107">
        <input type="submit" value="OK">
    </form>

    <hr>
    <div>
        <h4>CREATED:</h4>
        <pre>
          <code class='language-javascript'>
            <p> TEST PLACEHOLDER </p>
          </code>
        </pre>
        <hr>

        <h4>RETRIEVED:</h4>
        <pre>
          <code class='language-javascript'>
            <p> TEST PLACEHOLDER </p>
          </code>
        </pre>
        <hr>

        <h4>LISTED:</h4>
        <pre>
          <code class='language-javascript'>
            <p> TEST PLACEHOLDER </p>
          </code>
        </pre>

        <h4>DELETED:</h4>
        <pre>
          <code class='language-javascript'>
            <p> TEST PLACEHOLDER </p>
          </code>
        </pre>
    </div>
</body>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.25.0/axios.min.js" integrity="sha512-/Q6t3CASm04EliI1QyIDAA/nDo9R8FQ/BULoUFyN4n/BDdyIxeH7u++Z+eobdmr11gG5D/6nPFyDlnisDwhpYA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
        $(document).ready(() => {
            const form = document.querySelector("#addresses_form");
            if (!form) {
                console.warn('Unable to find form: #addresses_form');
                return;
            }
            form.onsubmit = async (event) => {
                event.preventDefault();
                event.stopPropagation();

                // Gather Data
                let data = {};
                for (const ele of event.target ) {
                    if (!ele.name || !ele.value) {
                        continue;
                    }
                    data = Object.assign({}, data, { [ele.name]: ele.value });
                }

                //Make Request
                axios.post(`http://localhost:5000/addresses`, data)
                    .then((resp) => {
                        // Update View
                        const nodes = document.querySelectorAll("code");
                        const data = resp.data;
                        console.log(data);

                        nodes[0].innerText = JSON.stringify(data.createdAddress, null, 2);
                        nodes[1].innerText = JSON.stringify(data.retrievedAddress, null, 2);
                        nodes[2].innerText = JSON.stringify(data.listedAddresses, null, 2);
                        nodes[3].innerText = JSON.stringify(data.deletedAddress, null, 2);
                    })
                    .catch((err) => {
                        console.error(err);
                    });
            };
        });
    </script>
</html>

